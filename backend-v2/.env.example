# RPC endpoints (Base network)
RPC_URL=https://mainnet.base.org
WS_RPC_URL=wss://mainnet.base.org

# Multi-RPC broadcasting (optional, comma-separated list)
# If provided, transactions will be broadcast to all RPCs simultaneously
# with automatic replacement strategy for faster inclusion
# Example: https://mainnet.base.org,https://base.llamarpc.com,https://base.meowrpc.com
BROADCAST_RPC_URLS=

# Transaction replacement policy (for multi-RPC broadcasting)
# Time to wait before replacing a transaction with higher gas (milliseconds)
REPLACE_AFTER_MS=3000
# Maximum number of replacement attempts before giving up
REPLACE_MAX_ATTEMPTS=3
# Gas fee bump percentage for each replacement (1-100)
FEE_BUMP_PCT=20

# Subgraph (The Graph Gateway)
SUBGRAPH_URL=https://gateway.thegraph.com/api/[api-key]/subgraphs/id/[subgraph-id]
# Optional: If using header auth instead of path-based auth
GRAPH_API_KEY=

# Aave V3 Base Pool
AAVE_POOL_ADDRESS=0xA238Dd80C259a72e81d7e4664a9801593F98d1c5
AAVE_PROTOCOL_DATA_PROVIDER=0x2d8A3C5677189723C4cB8873CfC9C8976FDF38Ac

# Aave base currency configuration
# On Base, check what the market's base currency is (typically USD or ETH)
# Base currency decimals (usually 8 for most Aave markets)
AAVE_BASE_CURRENCY_DECIMALS=8
# Is base currency USD? (false means ETH or another asset)
AAVE_BASE_CURRENCY_IS_USD=false

# Risk thresholds
MIN_DEBT_USD=50.0
HF_THRESHOLD_START=1.05
HF_THRESHOLD_EXECUTE=1.0

# Executor configuration (for PR2 - execution path)
EXECUTOR_ADDRESS=0x0000000000000000000000000000000000000000
EXECUTION_PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000000

# 1inch API (optional, for PR2)
ONEINCH_API_KEY=

# Execution control
# CRITICAL: Controls whether real liquidation transactions are sent on-chain
# - Set to "true" to enable real liquidation execution (DANGEROUS - use with care!)
# - Set to "false" for dry-run mode (logs only, no transactions sent)
# 
# Safety features when EXECUTION_ENABLED=true:
# - expectedCollateralOut must be > 0
# - minOut must be > debtToCover
# - Slippage within configured max (5%)
# - All safety checks must pass before tx is sent
EXECUTION_ENABLED=false

# Telegram notifications
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# Chainlink feeds (JSON format: {"SYMBOL": "0xFeedAddress", ...})
# Example: {"WETH":"0x71041dddad3595F9CEd3DcCFBe3D1F4b0a16Bb70","USDC":"0x..."}
# 
# IMPORTANT: ETH aliasing on Base network
# - On Base, ETH prices are often provided via WETH feeds
# - If you have a WETH feed but no ETH feed, priceMath will automatically alias ETH→WETH
# - This is safe because WETH is 1:1 with ETH
# 
# REQUIRED ratio feeds for liquid staking tokens (LSTs):
# These tokens require *_ETH ratio feeds, not direct USD feeds:
# - WSTETH_ETH: for wstETH USD pricing via WSTETH_ETH × ETH_USD composition
# - WEETH_ETH: for weETH USD pricing via WEETH_ETH × ETH_USD composition
# - CBETH_ETH: for cbETH USD pricing via CBETH_ETH × ETH_USD composition
# 
# The bot will automatically compose these ratio feeds with ETH_USD to get USD prices.
CHAINLINK_FEEDS_JSON=

# Address-first Chainlink feeds (JSON format: {"0xTokenAddress": "0xFeedAddress", ...})
# Example: {"0x4200000000000000000000000000000000000006":"0x71041dddad3595F9CEd3DcCFBe3D1F4b0a16Bb70"}
# 
# This enables address-first pricing WITHOUT symbol() calls in the execution path.
# When this is configured, getUsdPriceForAddress() will use this mapping directly
# instead of resolving address→symbol→feed.
# 
# This is OPTIONAL but RECOMMENDED for production as it avoids runtime symbol() queries.
CHAINLINK_FEEDS_BY_ADDRESS_JSON=

# Pyth Network (optional for prediction/re-scoring)
# Pyth price feeds can be enabled for predictive re-scoring (secondary cache)
# Chainlink remains the execution authority
# Set PYTH_ENABLED=true to enable Pyth streaming for prediction
PYTH_ENABLED=false
PYTH_WS_URL=wss://hermes.pyth.network/ws
PYTH_ASSETS=WETH,USDC,WBTC
PYTH_STALE_SECS=60
# Optional: Override feed IDs (JSON: {"WETH": "0xff61491a931112ddf1bd8147cd1b641375f79f5825126d665480874634fd0ace", "USDC": "0x..."})
PYTH_FEED_IDS_JSON=

# Pyth predictive re-scoring configuration
# Minimum percentage move to trigger re-scoring (default: 0.0005 = 0.05% = 5 bps)
PYTH_MIN_PCT_MOVE_DEFAULT=0.0005
# Optional: Per-token percentage move thresholds (JSON: {"WETH": 0.001, "USDC": 0.0001})
PYTH_MIN_PCT_MOVE_JSON=
# Minimum interval between predictive re-score checks in milliseconds (100-5000, default: 500)
PREDICT_MIN_RESCORE_INTERVAL_MS=500

# Optional: Aave UI Pool Data Provider for pair selection
AAVE_UI_POOL_DATA_PROVIDER=

# Optional: Override collateral/debt assets for pair selection
COLLATERAL_ASSET=
DEBT_ASSET=

# Price cache TTL (milliseconds)
# Controls how long prices are cached before requiring refresh from listener or RPC
# Lower values = more frequent updates, higher RPC usage
# Higher values = less frequent updates, lower RPC usage
PRICE_CACHE_TTL_MS=8000

# Universe seeding configuration
# Maximum number of candidate borrowers to seed from subgraph
# If not set, uses default from SubgraphSeeder (10000)
UNIVERSE_MAX_CANDIDATES=100000
# Page size for subgraph queries (default: 1000)
UNIVERSE_PAGE_SIZE=1000
# Delay between subgraph pages in milliseconds (default: 100)
UNIVERSE_POLITENESS_DELAY_MS=100

# Block heartbeat logging
# Enable periodic heartbeat logs showing system status per block
LOG_BLOCK_HEARTBEAT=false
# Log heartbeat every N blocks (1 = every block, 10 = every 10th block)
BLOCK_HEARTBEAT_EVERY_N=1
# Log the user address with minimum health factor in heartbeat (privacy-sensitive)
LOG_MINHF_USER=false

# Live event trace logging
# Enable detailed logging of Aave Pool events (Borrow, Repay, Supply, Withdraw)
LOG_LIVE_EVENTS=false
# Only log events for users in the watched/active risk set
LOG_LIVE_EVENTS_ONLY_WATCHED=true

# Dust liquidatable logging
# Log protocol-liquidatable accounts (HF < 1.0) that are excluded by MIN_DEBT_USD
# Useful for debugging why some liquidatable positions are ignored
LOG_DUST_LIQUIDATABLE=false
