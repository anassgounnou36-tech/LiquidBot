# Example configuration emphasizing header-mode usage

PORT=3000
NODE_ENV=development

USE_MOCK_SUBGRAPH=false
# Header-mode endpoint (preferred: key not in URL)
SUBGRAPH_URL=https://gateway.thegraph.com/api/subgraphs/id/GQFbb95cE6d8mV989mL5figjaGaKCQB3xqYrr1bRyXqF
GRAPH_API_KEY=replace_with_gateway_key

# (If you omit SUBGRAPH_URL the service defaults to path-embedded:
# https://gateway.thegraph.com/api/<GRAPH_API_KEY>/subgraphs/id/<DEPLOYMENT_ID>
# )

SUBGRAPH_POLL_INTERVAL_MS=15000

# Liquidation Tracking
# Maximum liquidations to fetch per poll (default: 50)
LIQUIDATION_POLL_LIMIT=50
# Maximum unique liquidation IDs to track (default: 5000)
LIQUIDATION_TRACK_MAX=5000

# Resilience & Metrics
SUBGRAPH_FAILURE_THRESHOLD=5
SUBGRAPH_RETRY_ATTEMPTS=3
SUBGRAPH_RETRY_BASE_MS=150
SUBGRAPH_RATE_LIMIT_CAPACITY=30
SUBGRAPH_RATE_LIMIT_INTERVAL_MS=10000

# Database
DATABASE_URL=postgres://postgres:postgres@localhost:5432/liquidbot

# Redis (choose either URL or host/port)
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
# REDIS_URL=redis://127.0.0.1:6379

# Aave Pool (Base)
AAVE_POOL_ADDRESS=0xA238Dd80C259a72e81d7e4664a9801593F98d1c5

# Aave V3 Pool for health factor checks (optional - defaults to Base V3 Pool if not set)
# Used by ExecutionService to verify user is liquidatable before executing
# AAVE_POOL=0xA238Dd80C259a72e81d7e4664a9801593F98d1c5

# Aave V3 Base Data Provider Addresses (for dynamic liquidation sizing)
AAVE_ADDRESSES_PROVIDER=0xe20fCBdBfFC4Dd138cE8b2E6FBb6CB49777ad64D
AAVE_PROTOCOL_DATA_PROVIDER=0xC4Fcf9893072d61Cc2899C0054877Cb752587981
AAVE_ORACLE=0x2Cc0Fc26eD4563A5ce5e8bdcfe1A2878676Ae156
AAVE_POOL_CONFIGURATOR=0x5731a04B1E775f0fdd454Bf70f3335886e9A96be
AAVE_UI_POOL_DATA_PROVIDER=0x68100bD5345eA474D93577127C11F39FF8463e93
AAVE_WRAPPED_TOKEN_GATEWAY=0xa0d9C1E9E48Ca30c8d8C3B5D69FF5dc1f6DFfC24

# Blockchain Connection (for on-chain execution and queries)
# RPC_URL is used by the executor and various validation scripts
# RPC_URL=https://mainnet.base.org
CHAIN_ID=8453

# Fork Testing (for local development with anvil/hardhat fork)
# Set these when testing with a local fork of Base mainnet
# FORK_TEST_PK=0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
# (Above is Anvil's default test key #0 - NEVER use on mainnet!)
# Usage: npm run fork:seed to create a test position with HF ≈ 1.02

# Liquidation Configuration
# Close factor determines how much debt can be repaid in a single liquidation (0.0-1.0)
# Default: 0.5 (50% of debt can be repaid)
LIQUIDATION_CLOSE_FACTOR=0.5

# Auth
JWT_SECRET=replace_me
API_KEY=dev_key

# Debug deeper subgraph errors
# SUBGRAPH_DEBUG_ERRORS=true

# Telegram Notifications (optional - will be disabled if not set)
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here

# Health Monitoring (thresholds kept for reference, monitoring disabled)
HEALTH_ALERT_THRESHOLD=1.10
HEALTH_EMERGENCY_THRESHOLD=1.05

# Profit Estimation
PROFIT_FEE_BPS=30
PROFIT_MIN_USD=10

# Price Oracle (placeholder for future integration)
PRICE_ORACLE_MODE=coingecko

# Health Factor Resolution Mode
# Note: Bulk monitoring disabled. Health factors resolved on-demand per liquidation.
HEALTH_QUERY_MODE=on_demand

# Poll Configuration
# Maximum new liquidations to process per poll (default: 5)
POLL_LIMIT=5
# Ignore first (bootstrap) batch for notifications/opportunity pipeline (default: true)
IGNORE_BOOTSTRAP_BATCH=true

# Gas Cost Estimation
# Gas cost in USD for profit calculations (default: 0)
GAS_COST_USD=0

# Chainlink Price Feeds (optional - falls back to stub prices if not configured)
# RPC URL for Chainlink price feed queries (used by scripts for diagnostics)
# Real-time listeners use the main WS provider (WS_RPC_URL) for event subscriptions
# CHAINLINK_RPC_URL=https://mainnet.base.org
# Comma-separated list of token:feedAddress pairs
# Direct USD feeds: ETH, USDC, etc.
# Ratio feeds (ending in _ETH): WSTETH_ETH, WEETH_ETH (automatically composed with ETH/USD)
# CHAINLINK_FEEDS=WETH:0x71041dddad3595F9CEd3DcCFBe3D1F4b0a16Bb70,USDC:0x7e860098F58bBFC8648a4311b374B1D669a2bc6B,WSTETH_ETH:0x43a5C292A453A3bF3606fa856197f09D7B74251a,WEETH_ETH:0xFC1415403EbB0c693f9a7844b92aD2Ff24775C65
# Price staleness threshold in seconds (default: 900 = 15 minutes)
# PRICE_STALENESS_SEC=900
# Enable ratio feed composition (default: true)
# RATIO_PRICE_ENABLED=true

# Price Feed Aliases and Derived Assets (optional - for Base-specific feed behavior)
# Comma-separated list of alias:target pairs (e.g., USDbC uses USDC pricing)
# PRICE_FEED_ALIASES=USDbC:USDC
# Comma-separated list of asset:ratioFeed pairs for derived pricing
# Derived assets are priced via ratio feeds (e.g., wstETH price = WSTETH_ETH ratio × WETH/USD)
# These assets will NOT be polled at asset-level, only via event listeners
# DERIVED_RATIO_FEEDS=wstETH:WSTETH_ETH,weETH:WEETH_ETH
# Number of consecutive errors before disabling polling for a feed (default: 3)
# Event listeners remain active even when polling is disabled
# PRICE_POLL_DISABLE_AFTER_ERRORS=3

# Price Readiness & Deferred Valuation (NEW - prevents missed liquidations during startup)
# Defer opportunities instead of skipping when price feeds not yet initialized (default: true)
# This prevents false "SCALING SUSPECTED" logs for assets like cbBTC during early runtime
PRICE_DEFER_UNTIL_READY=true
# Symbol aliases for normalization to handle variations (e.g., cbBTC vs CBBTC)
# Format: alias1:canonical1,alias2:canonical2
# PRICE_SYMBOL_ALIASES=cbBTC:CBBTC,tBTC:TBTC

# Price-Triggered Emergency Scans (RPC-optimized for volatile assets only)
# Enable price-triggered emergency scans on sharp collateral price drops (default: false)
# NOTE: Real-time service subscribes to NewTransmission (OCR2) events ONLY to prevent duplicate scans.
# AnswerUpdated subscription has been removed to avoid 2x multiplier on price-trigger RPC costs.
# Polling fallback (PRICE_TRIGGER_POLL_SEC) ensures price changes are detected if events are sparse.
PRICE_TRIGGER_ENABLED=false
#
# DEFAULT CONFIGURATION (RPC-optimized for volatile assets):
# - Monitors WETH only by default (set PRICE_TRIGGER_ASSETS to override)
# - Skips stablecoins (USDC/USDbC/EURC/GHO) automatically (set PRICE_TRIGGER_SKIP_STABLES=false to include them)
# - Uses near-band gating to scan only users with HF near liquidation threshold
# - Lower MAX_SCAN (250 vs 500) reduces RPC volume while preserving critical opportunities
#
# Minimum price drop in basis points to trigger emergency scan (default: 12 = 0.12%)
# Tightened from 30bps to catch volatile asset moves earlier
PRICE_TRIGGER_DROP_BPS=12
# Maximum number of candidates to scan after near-band filtering (default: 250, was 500)
# Lower cap reduces RPC volume; near-band gating ensures critical users are still checked
PRICE_TRIGGER_MAX_SCAN=250
# Comma-separated token symbols to monitor (default: WETH)
# Stablecoins are automatically excluded if PRICE_TRIGGER_SKIP_STABLES=true
PRICE_TRIGGER_ASSETS=WETH
# Debounce window in seconds to prevent repeated scans on rapid price updates (default: 60)
PRICE_TRIGGER_DEBOUNCE_SEC=60
# Cumulative price drop mode (default: false - recommended for single-round responsiveness)
# - Delta mode (false): triggers on each single-round price drop >= threshold
# - Cumulative mode (true): triggers when total drop from baseline >= threshold, then resets baseline
PRICE_TRIGGER_CUMULATIVE=false
# Polling interval in seconds for latestRoundData fallback (default: 15)
# Runs even when events are active, but respects debounce window. Lightweight: one call per feed.
PRICE_TRIGGER_POLL_SEC=15
# Per-asset price trigger thresholds (default: WETH:12)
# Format: "SYMBOL1:bps1,SYMBOL2:bps2" - Example: "WETH:12,WBTC:15"
PRICE_TRIGGER_BPS_BY_ASSET=WETH:12
# Per-asset debounce intervals (default: WETH:5)
# Format: "SYMBOL1:seconds1,SYMBOL2:seconds2" - Example: "WETH:5,WBTC:8"
PRICE_TRIGGER_DEBOUNCE_BY_ASSET=WETH:5
# Skip stablecoins for price-trigger scans (default: true)
# When true, automatically excludes stablecoins from PRICE_TRIGGER_STABLECOIN_LIST
# Rationale: Stable feeds update often but rarely produce HF-impacting changes
PRICE_TRIGGER_SKIP_STABLES=true
# Comma-separated list of stablecoin symbols to skip (default: USDC,USDBC,EURC,GHO)
# Only applies when PRICE_TRIGGER_SKIP_STABLES=true
PRICE_TRIGGER_STABLECOIN_LIST=USDC,USDBC,EURC,GHO
# Near-band gating: only scan users with HF close to liquidation (default: true)
# Dramatically reduces RPC volume by filtering to users in critical HF window before scanning
PRICE_TRIGGER_NEAR_BAND_ONLY=true
# Near-band width in basis points (default: 30 = 0.30%)
# Defines the HF window around liquidation threshold (e.g., HF ∈ [1.0008, 1.0150])
PRICE_TRIGGER_NEAR_BAND_BPS=30
# Reserve top-N borrowers to fetch before near-band filtering (default: 400)
# BorrowersIndexService fetches top-N borrowers per reserve, then applies near-band filter
PRICE_TRIGGER_RESERVE_TOP_N=400
# Jitter window for coalescing rapid same-block price updates (default: 40-60ms)
# Prevents duplicate scans when multiple price events fire in quick succession
PRICE_TRIGGER_JITTER_MIN_MS=40
PRICE_TRIGGER_JITTER_MAX_MS=60
# Lower bound for near-band filtering (default: 0.5)
# Safety guard to prevent scanning deeply underwater positions with HF << 1.0
PRICE_TRIGGER_NEAR_BAND_LOWER_BOUND=0.5

# At-Risk User Scanning (Optional)
# Number of users to scan per poll cycle (0 disables scanning)
AT_RISK_SCAN_LIMIT=50
# Health factor threshold for warning tier (HF below this triggers warning)
AT_RISK_WARN_THRESHOLD=1.05
# Health factor threshold for critical tier (HF below this is liquidatable)
AT_RISK_LIQ_THRESHOLD=1.0
# Debt threshold in ETH below which debt is considered dust (effectively zero)
AT_RISK_DUST_EPSILON=1e-9
# Whether to send notifications for critical tier users (default: true)
AT_RISK_NOTIFY_CRITICAL=true
# Whether to send notifications for warn tier users (default: false)
AT_RISK_NOTIFY_WARN=false

# Subgraph Feature Gating
# Master switch to enable/disable subgraph usage (default: false)
# When false: relies on on-chain discovery only via real-time events and startup backfill
# When true: uses subgraph for candidate seeding (requires GRAPH_API_KEY + SUBGRAPH_DEPLOYMENT_ID)
USE_SUBGRAPH=false
# Subgraph refresh interval in minutes for periodic candidate discovery (default: 30)
# Used by SubgraphSeeder to periodically refresh the full user universe
SUBGRAPH_REFRESH_MINUTES=30

# On-Chain Backfill for Candidate Discovery (default path when USE_SUBGRAPH=false)
# Enable/disable initial on-chain backfill on startup (default: true)
REALTIME_INITIAL_BACKFILL_ENABLED=true
# Number of blocks to scan backward from current block (default: 50000)
REALTIME_INITIAL_BACKFILL_BLOCKS=50000
# Size of each chunk when scanning logs (default: 2000)
REALTIME_INITIAL_BACKFILL_CHUNK_BLOCKS=2000
# Maximum number of logs to scan before stopping (default: 20000)
REALTIME_INITIAL_BACKFILL_MAX_LOGS=20000
# Optional dedicated RPC URL for backfill (recommended: use HTTP for backfill, WS for real-time)
# If not set, reuses the WS_RPC_URL provider
# Examples:
#   BACKFILL_RPC_URL=https://mainnet.base.org  (HTTP/HTTPS provider)
#   BACKFILL_RPC_URL=wss://mainnet.base.org     (WebSocket provider)
# BACKFILL_RPC_URL=

# Subgraph Paging (only when USE_SUBGRAPH=true)
# Page size for subgraph queries (min: 50, max: 1000, default: 100)
# Note: The Graph enforces a max of 1000 results per query
SUBGRAPH_PAGE_SIZE=100

# Head-Check Paging/Rotation (on-chain health factor checks)
# Strategy for head checks: 'all' or 'paged' (default: paged)
# - all: check all candidates every block (high RPC usage)
# - paged: rotate through candidates to reduce load
HEAD_CHECK_PAGE_STRATEGY=paged
# Number of candidates to include per head cycle when using paged strategy (default: 250)
HEAD_CHECK_PAGE_SIZE=250

# Execution Scaffold (default: disabled for safety)
# Master switch to enable execution (default: false)
EXECUTION_ENABLED=false
# Dry run mode - simulate without broadcasting transactions (default: true)
DRY_RUN_EXECUTION=true
# Optional MEV relay URL (e.g., https://rpc.flashbots.net)
# PRIVATE_BUNDLE_RPC=
# Maximum allowed gas price in Gwei (default: 50)
MAX_GAS_PRICE_GWEI=50
# Minimum profit after gas costs in USD (default: 10)
MIN_PROFIT_AFTER_GAS_USD=10
# Maximum position size in USD (default: 5000)
MAX_POSITION_SIZE_USD=5000
# Daily loss limit in USD (default: 1000)
DAILY_LOSS_LIMIT_USD=1000
# Comma-separated list of blacklisted token symbols (e.g., WBTC,XYZ)
# BLACKLISTED_TOKENS=

# On-Chain Executor Configuration
# Deployed LiquidationExecutor contract address
# EXECUTOR_ADDRESS=0x...
# Private key for execution transactions (keep secure!)
# EXECUTION_PRIVATE_KEY=0x...
# RPC URL for Base network
# RPC_URL=https://mainnet.base.org
# Chain ID for Base
CHAIN_ID=8453
# 1inch API key for swap quotes (optional - falls back to v5 public API if not set)
# ONEINCH_API_KEY=your_api_key_here
# 1inch API base URL (auto-configured based on API key presence)
# v6 with API key: https://api.1inch.dev/swap/v6.0/8453
# v5 without API key: https://api.1inch.exchange/v5.0/8453
ONEINCH_BASE_URL=https://api.1inch.dev/swap/v6.0/8453
# Maximum slippage in basis points (100 = 1%)
MAX_SLIPPAGE_BPS=100
# Close factor mode: auto or fixed (default: auto) - LEGACY, see CLOSE_FACTOR_EXECUTION_MODE
CLOSE_FACTOR_MODE=auto
# Close factor execution mode: fixed50 or full (default: fixed50)
# fixed50: safer default, liquidates 50% of debt (reduces capital requirement & race risk)
# full: liquidates 100% of debt (experimental, higher capital requirement)
CLOSE_FACTOR_EXECUTION_MODE=fixed50
# Liquidation debt assets (comma-separated addresses to prioritize; optional)
# If not set, will use largest debt position by value
# LIQUIDATION_DEBT_ASSETS=0x...
# Minimum repay size in USD (default: 50) - opportunities below this are rejected before quoting
MIN_REPAY_USD=50
# Maximum target users to recheck per event tick (default: 100) - bounds event-driven rechecks
MAX_TARGET_USERS_PER_TICK=100

# Real-time HF Detection (runtime feature, opt-in)
# Master switch for real-time detection (default: false for safety)
USE_REALTIME_HF=false
# WebSocket RPC URL (required when USE_REALTIME_HF=true)
WS_RPC_URL=wss://mainnet.base.org
# Optional: enable pending block polling for faster triggers (default: false)
USE_FLASHBLOCKS=false
# Flashblocks WebSocket URL (optional, defaults to WS_RPC_URL)
# FLASHBLOCKS_WS_URL=wss://...
# Pending block polling interval in milliseconds (default: 250)
# FLASHBLOCKS_TICK_MS=250
# Multicall3 address on Base (default: 0xca11bde05977b3631167028862be2a173976ca11)
MULTICALL3_ADDRESS=0xca11bde05977b3631167028862be2a173976ca11
# Aave Pool address for health factor checks (default: Base V3 Pool)
AAVE_POOL=0xA238Dd80C259a72e81d7e4664a9801593F98d1c5
# Health factor threshold in basis points (9800 = 0.98, below which user is liquidatable)
EXECUTION_HF_THRESHOLD_BPS=9800
# Subgraph candidate refresh cadence with jitter (seconds, default: 45)
REALTIME_SEED_INTERVAL_SEC=45
# Max candidates to maintain in memory (default: 300)
CANDIDATE_MAX=300
# Hysteresis threshold in basis points (20 = 0.20%, HF must worsen by this much to re-emit)
HYSTERESIS_BPS=20
# Only notify when liquidation plan is actionable (resolved debt/collateral) (default: true)
NOTIFY_ONLY_WHEN_ACTIONABLE=true
# Prevent multiple concurrent executions for the same user (default: true)
EXECUTION_INFLIGHT_LOCK=true

# Timeout and Recovery Configuration
# Per-chunk timeout for multicall operations in milliseconds (default: 2000)
# If a chunk takes longer than this, it will be aborted and retried
CHUNK_TIMEOUT_MS=2000
# Number of retry attempts for timed-out chunks (default: 2)
# Total attempts = 1 initial + CHUNK_RETRY_ATTEMPTS retries
CHUNK_RETRY_ATTEMPTS=2
# Run-level stall detection timeout in milliseconds (default: 5000)
# If a run makes no progress for this duration, it will be aborted and restarted
RUN_STALL_ABORT_MS=5000
# WebSocket heartbeat interval in milliseconds (default: 15000)
# IMPORTANT: To avoid dirty entries expiring before observation, set DIRTY_TTL_SEC >= 2×PRICE_TRIGGER_DEBOUNCE_SEC
# Example: if PRICE_TRIGGER_DEBOUNCE_SEC=60, use DIRTY_TTL_SEC=600 (10 minutes)
# Default recommendation: DIRTY_TTL_SEC=600 when using price triggers
# If no blocks or activity for this duration, WS connection will be reset
WS_HEARTBEAT_MS=15000

# Optional Secondary RPC for Head-Check Fallback
# Secondary RPC URL to use when primary times out (optional)
# SECONDARY_HEAD_RPC_URL=https://mainnet.base.org

# RPC-only Tuning and Stability Configuration
# Multicall batch size for sub-batch operations (default: 120)
# Increase for paid Alchemy plans (150-200 recommended), decrease if hitting rate limits
MULTICALL_BATCH_SIZE=120
# Enable adaptive adjustment of HEAD_CHECK_PAGE_SIZE based on latency/timeout rates (default: true)
HEAD_PAGE_ADAPTIVE=true
# Target maximum elapsed time per head page run in milliseconds (default: 900)
# Adaptive logic adjusts page size to keep within this target
HEAD_PAGE_TARGET_MS=900
# Lower bound on dynamic page size in candidates per block (default: 600)
HEAD_PAGE_MIN=600
# Upper bound for adaptive page size (default: HEAD_CHECK_PAGE_SIZE or 2400)
# HEAD_PAGE_MAX=2400
# Hedge window in milliseconds for early secondary provider race (default: 300, 0 disables)
# If set and SECONDARY_HEAD_RPC_URL is present, fire hedge request after this delay
# HEAD_CHECK_HEDGE_MS=300
# Debounce window in milliseconds to coalesce event triggers per block/reserve (default: 120)
EVENT_BATCH_COALESCE_MS=120
# Cap event-driven batch executions per block to avoid starvation (default: 2)
EVENT_BATCH_MAX_PER_BLOCK=2
# Maximum parallel event batches to avoid provider contention with head sweeps (default: 1)
MAX_PARALLEL_EVENT_BATCHES=1

# Adaptive Event Concurrency (optional - reduces missed liquidations during high activity)
# Enable adaptive scaling of event batch concurrency (default: false)
# ADAPTIVE_EVENT_CONCURRENCY=false
# Maximum event batch concurrency when scaled up (default: 6)
# MAX_PARALLEL_EVENT_BATCHES_HIGH=6
# Threshold of skipped batches over 20-block window to trigger scale-up (default: 5)
# EVENT_BACKLOG_THRESHOLD=5

# USD-Based Dust Threshold (optional - filters tiny liquidations)
# Minimum USD value for debt repay and collateral seized (default: 20 if set, falls back to raw threshold if unset)
# DUST_MIN_USD=20
# Minimum total debt in USD to include user in candidate list (default: 1)
# MIN_DEBT_USD=1

# Real-time HF Harness Configuration (test-only utility)
# Comma-separated candidate user addresses for monitoring (harness only)
# CANDIDATE_USERS=0x123...,0x456...
# Alternative: use subgraph to seed candidates (requires GRAPH_API_KEY + SUBGRAPH_DEPLOYMENT_ID)
# Number of users to seed from subgraph (default: 50)
SEED_LIMIT=50
# Duration to run harness in seconds (default: 60)
HARNESS_DURATION_SEC=60
# Optional Chainlink price feeds for additional price-trigger subscriptions
# Format: TOKEN:FEED_ADDRESS,TOKEN:FEED_ADDRESS (e.g., ETH:0x71041dddad3595F9CEd3DcCFBe3D1F4b0a16Bb70,USDC:0x7e860098F58bBFC8648a4311b374B1D669a2bc6B)
# CHAINLINK_FEEDS=

# Low Health Factor Observability Tracker
# Enable non-intrusive tracking of low HF candidates for diagnostics (default: true)
LOW_HF_TRACKER_ENABLED=true
# Maximum number of low HF entries to track in memory (default: 1000)
LOW_HF_TRACKER_MAX=1000
# Recording mode: 'all' (all low-HF candidates) or 'min' (only minimum HF per batch) (default: all)
LOW_HF_RECORD_MODE=all
# Dump tracked entries to file on graceful shutdown (default: true)
LOW_HF_DUMP_ON_SHUTDOWN=true
# Interval in seconds for periodic summary logs (0 to disable) (default: 900 = 15 minutes)
LOW_HF_SUMMARY_INTERVAL_SEC=900
# Enable extended tracking with per-reserve data for deterministic verification (default: true)
LOW_HF_EXTENDED_ENABLED=true

# Diagnostics (optional)
# Blocks to scan for Chainlink AnswerUpdated logs (default: 5000)
# DIAG_FEED_BLOCKS=5000
# Blocks to scan for recent Aave user activity (default: 10000)
# DIAG_AAVE_BLOCKS=10000
# Per-call timeout for diagnostics (ms, default: 8000)
# DIAG_TIMEOUT_MS=8000

# Liquidation Audit (optional - tracks missed liquidations and classifies reasons)
# Enable liquidation audit feature (default: true)
LIQUIDATION_AUDIT_ENABLED=true
# Send Telegram notifications for audited liquidations (default: true)
LIQUIDATION_AUDIT_NOTIFY=true
# Price mode for valuation: 'aave_oracle' for on-chain oracle, 'block' for block-tagged reads, 'current' for latest (default: aave_oracle)
LIQUIDATION_AUDIT_PRICE_MODE=aave_oracle
# Sample limit: messages per minute (0 = unlimited) (default: 0)
LIQUIDATION_AUDIT_SAMPLE_LIMIT=0
# Enable decision trace recording for missed liquidation classification (default: true when LIQUIDATION_AUDIT_ENABLED=true)
# DECISION_TRACE_ENABLED=true
# Enable audit classifier for reason code generation (default: true when LIQUIDATION_AUDIT_ENABLED=true)
# AUDIT_CLASSIFIER_ENABLED=true

# Pricing Configuration
# Use Aave PriceOracle for USD valuations (default: false)
# When true, pricing uses on-chain Aave oracle instead of fallback methods
PRICES_USE_AAVE_ORACLE=true

# Priority Sweep (optional - curated priority set for focused scanning)
# Enable priority sweep subsystem (default: false)
PRIORITY_SWEEP_ENABLED=false
# Sweep interval in minutes (default: 60)
PRIORITY_SWEEP_INTERVAL_MIN=60
# Minimum debt in USD to include user (default: 500)
PRIORITY_MIN_DEBT_USD=500
# Minimum collateral in USD to include user (default: 1500)
PRIORITY_MIN_COLLATERAL_USD=1500
# Target number of users to select (default: 12000)
PRIORITY_TARGET_SIZE=12000
# Maximum users to scan before stopping (default: 120000)
PRIORITY_MAX_SCAN_USERS=120000
# Scoring weight for debt (default: 1.0)
PRIORITY_SCORE_DEBT_WEIGHT=1.0
# Scoring weight for collateral (default: 0.8)
PRIORITY_SCORE_COLLATERAL_WEIGHT=0.8
# Health factor penalty weight (default: 2.5)
PRIORITY_SCORE_HF_PENALTY=2.5
# Health factor ceiling for penalty (default: 1.20)
PRIORITY_SCORE_HF_CEILING=1.20
# Low HF boost multiplier (default: 1.1)
PRIORITY_SCORE_LOW_HF_BOOST=1.1
# Log summary after each sweep (default: true)
PRIORITY_SWEEP_LOG_SUMMARY=true
# Enable Prometheus metrics (default: true)
PRIORITY_SWEEP_METRICS_ENABLED=true
# Sweep timeout in milliseconds (default: 240000 = 4 minutes)
PRIORITY_SWEEP_TIMEOUT_MS=240000
# Page size for subgraph queries (default: 1000)
PRIORITY_SWEEP_PAGE_SIZE=1000
# Delay between subgraph requests in milliseconds (default: 100)
PRIORITY_SWEEP_INTER_REQUEST_MS=100
# Health factor threshold for hotlist promotion (default: 1.05)
HOTLIST_MAX_HF=1.05

# Hotlist / Hot-Set Tracking (near-threshold user management)
# Enable hotlist tracking (alias: HOT_SET_ENABLED) (default: true)
HOTLIST_ENABLED=true
# Minimum HF for hotlist inclusion (default: 0.99)
HOTLIST_MIN_HF=0.99
# Maximum HF for hotlist inclusion (default: 1.03)
HOTLIST_MAX_HF=1.03
# Minimum debt in USD for hotlist inclusion (default: 5)
HOTLIST_MIN_DEBT_USD=5
# Maximum hotlist size (default: 2000)
HOTLIST_MAX=2000
# Hotlist refresh interval in seconds (default: 5)
HOTLIST_REVISIT_SEC=5

# Legacy hot/warm set parameters (kept for backward compatibility)
# Enable hot/warm set tracking (default: true)
HOT_SET_ENABLED=true
# Maximum HF for hot set (imminent liquidation risk) (default: 1.03)
HOT_SET_HF_MAX=1.03
# Maximum HF for warm set (approaching liquidation) (default: 1.10)
WARM_SET_HF_MAX=1.10
# Maximum size of hot set (default: 1000)
MAX_HOT_SIZE=1000
# Maximum size of warm set (default: 5000)
MAX_WARM_SIZE=5000

# Liquidation Calldata Precomputation
# Enable precomputation for hot accounts (default: true)
PRECOMPUTE_ENABLED=true
# Number of top accounts to precompute (default: 500)
PRECOMPUTE_TOP_K=500
# Close factor percentage for precomputed liquidations (default: 50)
PRECOMPUTE_CLOSE_FACTOR_PCT=50
# Receive aToken instead of underlying asset (default: false)
PRECOMPUTE_RECEIVE_A_TOKEN=false

# Price-Feed Fast Path (Chainlink AnswerUpdated events)
# Enable fast path for price changes (default: true)
PRICE_FASTPATH_ENABLED=true
# Assets to monitor for price changes (comma-separated) (default: WETH,WBTC,cbETH,USDC,AAVE)
PRICE_FASTPATH_ASSETS=WETH,WBTC,cbETH,USDC,AAVE

# Gas Strategy Configuration
# Gas strategy: 'dynamic_v1' for dynamic pricing (default: dynamic_v1)
GAS_STRATEGY=dynamic_v1
# Maximum fee multiplier over base fee (default: 1.3)
GAS_MAX_FEE_MULTIPLIER=1.3
# Minimum priority fee in Gwei (default: 0.05)
GAS_MIN_PRIORITY_GWEI=0.05
# Use private transaction submission (default: false)
USE_PRIVATE_TX=false

# Shadow Execution (Logging-Only Pre-Execution Verification)
# Enable shadow execution hooks for pre-execution verification (default: false)
# When enabled, produces structured JSON logs of WOULD-BE liquidation attempts without submitting transactions
SHADOW_EXECUTE_ENABLED=false
# Health factor threshold below which shadow execution is triggered (default: 1.005)
# Only users with HF below this threshold will trigger shadow execution logs
SHADOW_EXECUTE_THRESHOLD=1.005

# ==== HIGH-IMPACT SPEED FEATURES (Aave V3 Base Liquidation Competitiveness) ====

# Optimistic Execution (Feature #1)
# Enable optimistic dispatch - immediate execution when cached HF is sufficiently below 1.0 (default: false)
# When enabled, skips synchronous pre-flight HF recheck for strong liquidation candidates
OPTIMISTIC_ENABLED=false
# Epsilon margin in basis points - immediate execution when HF < (1.0 - ε) (default: 5 = 0.05% = 0.0005)
# Example: with 5 bps, HF < 0.9995 triggers optimistic path
OPTIMISTIC_EPSILON_BPS=5
# Maximum allowed optimistic reverts per day before disabling optimistic path (default: 50)
# Resets at UTC midnight
OPTIMISTIC_MAX_REVERTS=50

# Multi-RPC Write Racing (Feature #2)
# Comma-separated list of write RPC endpoints for parallel broadcast (leave empty to use single RPC_URL)
# Example: WRITE_RPCS=https://rpc1.base.org,https://rpc2.base.org,https://rpc3.base.org
WRITE_RPCS=
# Hedge timeout in milliseconds - delay before firing secondary RPCs if first group is slow (default: 120)
WRITE_RACE_TIMEOUT_MS=120

# Multiple Executor Keys / Nonce Sharding (Feature #3)
# Comma-separated private keys (without 0x prefix) for parallel execution capability
# Leave empty to use single EXECUTION_PRIVATE_KEY
# WARNING: Keep secure! Never commit to version control!
# Example: EXECUTION_PRIVATE_KEYS=abc123...,def456...,ghi789...
EXECUTION_PRIVATE_KEYS=

# Timed Gas Bump / RBF Burst Strategy (Feature #4)
# Enable automatic gas price bumping for pending transactions (default: false)
GAS_BURST_ENABLED=false
# Time in milliseconds after which first gas bump is triggered (default: 150)
GAS_BURST_FIRST_MS=150
# Time in milliseconds after which second gas bump is triggered (default: 300)
GAS_BURST_SECOND_MS=300
# Percentage increase for first gas bump (default: 25 = +25%)
GAS_BURST_FIRST_PCT=25
# Percentage increase for second gas bump (default: 25 = +25%)
GAS_BURST_SECOND_PCT=25
# Maximum number of gas bumps allowed per transaction (default: 2)
GAS_BURST_MAX_BUMPS=2

# Precomputed Calldata Templates (Feature #5)
# Enable calldata template caching for faster transaction construction (default: false)
CALLDATA_TEMPLATE_ENABLED=false
# Variable debt index change in basis points that triggers template refresh (default: 10 = 0.10%)
TEMPLATE_REFRESH_INDEX_BPS=10

# Second-Order Liquidation Chaining (Feature #6)
# Enable re-evaluation of affected users when competitor liquidations are detected (default: false)
SECOND_ORDER_CHAIN_ENABLED=false

# Latency Instrumentation (Feature #7)
# Enable detailed end-to-end latency tracking and metrics (default: false)
LATENCY_METRICS_ENABLED=false

# Emergency Asset Scans Optimization (Feature #8)
# Maximum users to scan during emergency asset-scoped sweeps (default: 250)
EMERGENCY_SCAN_MAX_USERS=250
# Health factor band in basis points for emergency asset scans (default: 300 = HF < 1.03)
EMERGENCY_SCAN_ASSET_HF_BAND_BPS=300

# ==== Coverage Improvements & Startup Diagnostics ====
# Borrowers Index backfill (increased from 50k to 400k for better coverage)
BORROWERS_INDEX_BACKFILL_BLOCKS=400000

# Reserve-targeted rechecks (increased defaults for better coverage)
RESERVE_RECHECK_TOP_N=800
RESERVE_RECHECK_MAX_BATCH=1200
# Per-asset overrides for reserve rechecks (e.g., "cbBTC:1500,cbETH:1200,WBTC:1000")
RESERVE_RECHECK_TOP_N_BY_ASSET=
# Minimum index delta in basis points to trigger reserve recheck (default: 2 = 0.02%)
# Skips wide sweeps when liquidityIndex/variableBorrowIndex changes are tiny
RESERVE_MIN_INDEX_DELTA_BPS=2
# Enable reserve event coalescing (default: true)
# Merges adjacent ReserveDataUpdated events within same block into single recheck
RESERVE_COALESCE_ENABLED=true

# Startup diagnostics
STARTUP_DIAGNOSTICS=true
STARTUP_DIAG_TIMEOUT_MS=10000

# Mempool transmit monitoring (Phase 1 feature)
TRANSMIT_MEMPOOL_ENABLED=false
MEMPOOL_SUBSCRIPTION_MODE=auto

# Metrics configuration
LATENCY_METRICS_ENABLED=false
METRICS_EMIT_INTERVAL_BLOCKS=10

# Auto-discovery of Chainlink feeds for mempool monitoring
AUTO_DISCOVER_FEEDS=true

# ==== SPRINTER HIGH-PRIORITY EXECUTION PATH ====
# Ultra-low-latency execution path that pre-stages liquidation data to minimize latency
# and win liquidation races on Base's private mempool

# Enable Sprinter execution path (default: false)
SPRINTER_ENABLED=false

# Pre-staging Health Factor threshold in basis points (default: 10200 = 1.02)
# Accounts with projected HF below this threshold are pre-staged for fast execution
PRESTAGE_HF_BPS=10200

# Maximum number of pre-staged candidates to maintain (default: 1000)
SPRINTER_MAX_PRESTAGED=1000

# Number of blocks after which pre-staged candidates are considered stale (default: 10)
SPRINTER_STALE_BLOCKS=10

# Batch size for micro-verification multicall (default: 25)
# Limits the number of HF checks performed per verification round
SPRINTER_VERIFY_BATCH=25

# Comma-separated list of write RPC URLs for parallel transaction broadcasting
# Example: https://base-mainnet.g.alchemy.com/v2/KEY1,https://mainnet.base.org
WRITE_RPCS=

# Timeout for write race in milliseconds (default: 2000)
# Maximum time to wait for any RPC endpoint to accept the transaction
WRITE_RACE_TIMEOUT_MS=2000

# Enable optimistic execution mode (default: false)
# When enabled, allows execution when HF is slightly above threshold but within epsilon
OPTIMISTIC_ENABLED=false

# Optimistic execution epsilon in basis points (default: 20 = 0.20%)
# Maximum HF deviation above threshold to allow optimistic execution
OPTIMISTIC_EPSILON_BPS=20

# Comma-separated list of execution private keys for multi-key parallel execution
# Keys are selected by hashing user address to distribute nonce contention
# Falls back to EXECUTION_PRIVATE_KEY if not set
EXECUTION_PRIVATE_KEYS=

# Template refresh interval in basis points (default: 10000 = refresh every 100 blocks)
# Calldata templates are refreshed after this many blocks to account for contract changes
TEMPLATE_REFRESH_INDEX_BPS=10000

# ==== REDIS L2 CACHE & COORDINATION (High-Performance Features) ====

# Redis Configuration
REDIS_URL=redis://127.0.0.1:6379
# Enable Redis pipelining for batch operations (default: true)
REDIS_ENABLE_PIPELINING=true
# Maximum commands per pipeline batch (default: 500)
REDIS_MAX_PIPELINE=500
# Enable MessagePack compression for cache payloads (default: false)
RISK_CACHE_COMPRESS=false

# Borrowers Index Redis Backend
# Mode: memory, redis, or postgres (default: memory)
BORROWERS_INDEX_MODE=memory
# Optional dedicated Redis URL for borrowers index (falls back to REDIS_URL)
BORROWERS_INDEX_REDIS_URL=

# ==== PREDICTIVE HEALTH FACTOR ENGINE ====

# Enable predictive HF projection (default: false)
PREDICTIVE_ENABLED=false
# Health factor buffer in basis points for prediction threshold (default: 40 = 0.40%)
# Triggers prediction when HF projected to cross below 1.0 + buffer
PREDICTIVE_HF_BUFFER_BPS=40
# Maximum users to evaluate per predictive tick (default: 800)
PREDICTIVE_MAX_USERS_PER_TICK=800
# Projection horizon in seconds (default: 180 = 3 minutes)
PREDICTIVE_HORIZON_SEC=180
# Prediction scenarios to evaluate: baseline,adverse,extreme (default: baseline,adverse)
# baseline: current price trajectory
# adverse: -1σ price move
# extreme: -2σ price move (can be dropped to reduce RPC load)
# Recommended: baseline,adverse (extreme can re-enable later if needed)
PREDICTIVE_SCENARIOS=baseline,adverse
# Near-band filtering for predictive (reduces RPC volume) (default: true)
# When true, only process users with HF near liquidation threshold
PREDICTIVE_NEAR_ONLY=true
# Near-band threshold in basis points (default: 30 = 0.30%)
# Users with HF > 1.0 + threshold are skipped unless projected HF is critical
PREDICTIVE_NEAR_BAND_BPS=30
# Fallback evaluation interval in blocks when events are quiet (default: 20)
PREDICTIVE_FALLBACK_INTERVAL_BLOCKS=20
# Fallback evaluation interval in milliseconds (default: 30000 = 30 seconds)
PREDICTIVE_FALLBACK_INTERVAL_MS=30000
# Enable fallback evaluation when no signals (default: false)
# When false, predictive ONLY runs on price signals (Pyth, TWAP, Chainlink)
# Set to true to allow periodic fallback scans even without signals
PREDICTIVE_FALLBACK_ENABLED=false
# Fast-path predictive ETA cap in seconds (default: 45)
# Candidates with ETA below this and HF < 1.0 are flagged for fast-path
FASTPATH_PREDICTIVE_ETA_CAP_SEC=45
# Priority score weights for predictive candidates
PREDICTIVE_PRIORITY_HF_WEIGHT=1.0
PREDICTIVE_PRIORITY_ETA_WEIGHT=1.0
PREDICTIVE_PRIORITY_DEBT_WEIGHT=0.6
# Scenario severity weights (higher = more severe = higher priority)
PREDICTIVE_PRIORITY_SCENARIO_WEIGHT_BASELINE=1.0
PREDICTIVE_PRIORITY_SCENARIO_WEIGHT_ADVERSE=1.15
PREDICTIVE_PRIORITY_SCENARIO_WEIGHT_EXTREME=1.3

# ==== PREDICTIVE RPC OPTIMIZATION (Signal Gating & Budget Control) ====
# Enable signal-based gating (default: true)
# When true, predictive only runs on validated price signals, not every block
PREDICTIVE_SIGNAL_GATE_ENABLED=true
# Pyth price delta threshold for triggering predictive (default: 0.01 = 1%)
# Predictive evaluates when Pyth price changes by at least this percentage
PREDICTIVE_PYTH_DELTA_PCT=0.01
# Maximum predictive evaluation ticks per minute (default: 6)
# Prevents excessive RPC load by rate-limiting evaluation frequency
PREDICTIVE_MAX_TICKS_PER_MIN=6
# Hourly RPC budget for predictive operations in USD (default: 1.5)
# Estimated spend is tracked; predictive stops for remainder of hour if exceeded
# Example: $1.50/hour prevents runaway costs during volatile periods
PREDICTIVE_RPC_BUDGET_USD_PER_HOUR=1.5
# Maximum users to evaluate per signal per asset (default: 60)
# Caps evaluation scope to prevent large batches overwhelming provider
PREDICTIVE_MAX_USERS_PER_SIGNAL_PER_ASSET=60
# Deduplication cache TTL in seconds (default: 120 = 2 minutes)
# Prevents re-evaluating same user within this window unless stronger signal
PREDICTIVE_DEDUP_CACHE_TTL_SEC=120
# Deduplication cache maximum size (default: 1000 entries)
PREDICTIVE_DEDUP_CACHE_MAX_SIZE=1000
# Per-user block debounce (default: 3 blocks)
# Minimum blocks between predictive evaluations of same user
PER_USER_BLOCK_DEBOUNCE=3
# Enable index jump prediction (default: false)
# When true, triggers predictive on large variable borrow index jumps
# Gated behind INDEX_JUMP_MIN_BPS threshold and budget checks
INDEX_JUMP_PREDICTION_ENABLED=false
# Minimum index jump in basis points to trigger (default: 6 = 0.06%)
# Only used when INDEX_JUMP_PREDICTION_ENABLED=true
INDEX_JUMP_MIN_BPS=6

# ==== TIER 0 + TIER 1 PERFORMANCE UPGRADES ====
# These features reduce HF detection latency and improve liquidation race competitiveness

# Tier 0: Fast Subset Before Large Sweeps
# Delay large reserve sweep to allow subset micro-verifies to complete first (default: 80ms)
RESERVE_FAST_SUBSET_SWEEP_DELAY_MS=80

# Tier 0: Disable Hedging For Single Micro-Verifies
# When false, single-account micro-verifies skip hedging to reduce latency (default: false)
MICRO_VERIFY_HEDGE_FOR_SINGLE=false
# Optional dedicated RPC endpoint for micro-verification (leave empty to use default)
MICRO_VERIFY_DEDICATED_RPC=
# Micro-verify HF cache TTL in milliseconds (default: 1200)
# Caches health factor reads to avoid redundant RPC calls across predictive/reserve/price paths
# Note: MICRO_VERIFY_HF_CACHE_TTL_MS takes precedence if both are set
# MICRO_VERIFY_CACHE_TTL_MS is kept for backward compatibility
MICRO_VERIFY_HF_CACHE_TTL_MS=1200

# Tier 0: Immediate Post-Liquidation Refresh
# Synchronously refresh HF after LiquidationCall events (default: true)
POST_LIQUIDATION_REFRESH=true

# Tier 0: Address Normalization
# Enforce lowercase normalization for all address keys (default: true)
ADDRESS_NORMALIZE_LOWERCASE=true

# Tier 1: Index Jump Prediction
# Basis point threshold for index jump detection (default: 3 = 0.03%)
INDEX_JUMP_BPS_TRIGGER=3
# Critical HF threshold for predicted values (default: 1.0008)
HF_PRED_CRITICAL=1.0008

# Tier 1: Risk Ordering Enhancement
# Enable simple risk-based ordering for near-threshold queue (default: true)
RISK_ORDERING_SIMPLE=true

# ==== CRITICAL LANE FAST PATH (Phases 1 & 2) ====
# Enable critical lane low-latency execution for HF < 1.0 (default: true)
CRITICAL_LANE_ENABLED=true
# Load shedding: suppress head sweeps while critical attempts in-flight (default: true)
CRITICAL_LANE_LOAD_SHED=true
# Reverification mode: snapshot_only | mini_multicall (default: mini_multicall)
CRITICAL_LANE_REVERIFY_MODE=mini_multicall
# Maximum reserves to include in mini-multicall reverify (default: 6)
CRITICAL_LANE_MAX_REVERIFY_RESERVES=6
# Latency warning threshold in milliseconds (default: 250)
CRITICAL_LANE_LATENCY_WARN_MS=250
# Abort attempt if latency exceeds this threshold in milliseconds (default: 600)
CRITICAL_LANE_LATENCY_ABORT_MS=600
# Override minimum debt USD for fast path (default: 50)
CRITICAL_LANE_MIN_DEBT_USD=50
# Override minimum profit USD for fast path (default: 10)
CRITICAL_LANE_MIN_PROFIT_USD=10
# Allow unprofitable execution on first attempt for testing (default: false)
CRITICAL_LANE_ALLOW_UNPROFITABLE_INITIAL=false
# Price fast TTL (ms) - how long prices from snapshot are valid (default: 5000)
PRICE_FAST_TTL_MS=5000
# User snapshot TTL (ms) - how long user snapshots are valid (default: 4000)
USER_SNAPSHOT_TTL_MS=4000
# Template refresh interval (ms) - how often to refresh calldata templates (default: 60000)
TEMPLATE_REFRESH_INTERVAL_MS=60000
# Fast gas mode: cache_then_estimate | estimate_only | cache_only (default: cache_then_estimate)
FAST_GAS_MODE=cache_then_estimate
# Private TX RPC URL for builder submission (optional, e.g., https://builder.example.org)
# PRIVATE_TX_RPC=
# Private TX mode: bundle | direct | disabled (default: disabled)
PRIVATE_TX_MODE=disabled
# Redis pipeline enabled for batch operations (default: true)
REDIS_PIPELINE_ENABLED=true

# ==== FASTPATH LATENCY & INSTRUMENTATION (Phase 2) ====
# Enable fast-path latency instrumentation and detailed logging (default: true)
FASTPATH_LATENCY_ENABLED=true
# Enable hedge suppression for small chunks (≤5 calls) to reduce latency (default: true)
FASTPATH_HEDGE_SMALL_DISABLE=true
# Price cache TTL for fast-path in milliseconds (default: 5000)
FASTPATH_PRICE_CACHE_TTL_MS=5000
# Gas cache TTL for fast-path in milliseconds (default: 4000)
FASTPATH_GAS_CACHE_TTL_MS=4000
# Enable event publishing to critical_lane.events Redis channel (default: true)
FASTPATH_EVENT_PUBLISH=true
# Minimum HF threshold for publishing to critical lane (default: 1.0, publishes HF<1)
CRITICAL_LANE_PUBLISH_MIN_HF=1.0
# Minimum HF threshold for executing via critical lane (default: 1.0)
CRITICAL_LANE_MIN_EXECUTE_HF=1.0
# Enable detailed fast-path logging for debugging (default: true)
FASTPATH_LOG_DETAIL=true
# Enable fast-path latency metrics (Prometheus) (default: true)
FASTPATH_LATENCY_METRICS=true

# ==== FILE LOGGING CONFIGURATION ====
# Enable file logging with daily rotation (default: false)
LOG_FILE_ENABLED=false
# File log retention in hours (default: 8)
# Rotated log files older than this will be pruned
LOG_FILE_RETENTION_HOURS=8

# ==== PYTH NETWORK INTEGRATION ====
# Enable Pyth price feeds for predictive early-warning
PYTH_ENABLED=false
# Pyth Hermes HTTP URL base (for REST API price queries)
# Note: Base URL only - endpoints like /v2/updates/price/latest are appended by the code
# For live prices, use: https://hermes.pyth.network (not /v2/price_feeds)
PYTH_HTTP_URL=https://hermes.pyth.network
# Pyth Hermes WebSocket URL for real-time price streaming
PYTH_WS_URL=wss://hermes.pyth.network/ws
# Comma-separated list of asset symbols to track (e.g., WETH,WBTC,cbETH,USDC)
PYTH_ASSETS=WETH,WBTC,cbETH,USDC
# Maximum age in seconds before price considered stale (default: 10)
PYTH_STALE_SECS=10
# Path to JSON file mapping asset symbols to Pyth feed IDs (optional)
# Example: ./config/pyth-feeds.json (see config/pyth-feeds.sample.json)
# PYTH_FEED_MAP_PATH=

# ==== TWAP SANITY CHECK CONFIGURATION ====
# Enable DEX TWAP sanity checking
TWAP_ENABLED=false
# TWAP window in seconds (default: 300 = 5 minutes)
TWAP_WINDOW_SEC=300
# Maximum allowed price deviation percentage (default: 0.012 = 1.2%)
TWAP_DELTA_PCT=0.012
# JSON array of pool configs: [{"symbol":"WETH","pool":"0x...","dex":"uniswap_v3","fee":500,"quote":"USDC"}]
# Use scripts/discover-twap-pools.mjs to discover pools
# TWAP_POOLS=

# ==== PRE-SUBMIT LIQUIDATION PIPELINE ====
# Enable pre-submit liquidation transactions ahead of Chainlink updates
PRE_SUBMIT_ENABLED=false
# Maximum ETA in seconds to consider for pre-submit (default: 90)
PRE_SUBMIT_ETA_MAX=90
# Health factor trigger buffer (default: 1.02)
HF_TRIGGER_BUFFER=1.02
# Gas price margin/buffer percentage (default: 0.10 = 10%)
GAS_PRICE_MARGIN=0.10
# Time-to-live in blocks for pending pre-submits (default: 40)
TTL_BLOCKS=40
# Minimum position size in USD (optional, defaults to MIN_DEBT_USD)
# PRE_SUBMIT_MIN_POSITION_USD=
# Enable telemetry for pre-submit pipeline
TELEMETRY_PRE_SUBMIT_ENABLED=true
